color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL) +
theme_light(base_size = 16)
projection_plot
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1850 &
year < 2020)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2)
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1850 &
year < 2021)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2)
View(score0result_df)
matilda:::adjusted_gmst_data
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1950 &
year < 2021)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1948 &
year < 2021)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
global_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 2024 &
year < 2101)
plot_data <- global_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
plot_data$scenario <- as.factor(plot_data$scenario)
colors <- c("#6FB2C1", "#F11B00")
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL) +
theme_light(base_size = 16)
projection_plot
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1948 &
year < 2023)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1948 &
year < 2024)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1948 &
year < 2025)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
global_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 2023 &
year < 2101)
plot_data <- global_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
plot_data$scenario <- as.factor(plot_data$scenario)
colors <- c("#6FB2C1", "#F11B00")
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL) +
theme_light(base_size = 16)
projection_plot
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1948 &
year < 2025)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
# filter out models with a weight > 1e-6
score0result_df <- subset(score0result_df, mc_weights > 1.0e-06)
# filter out models with a weight > 1e-6
score0result_df <- subset(score0result_df, mc_weight > 1.0e-06)
global_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 2023 &
year < 2101)
plot_data <- global_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
plot_data$scenario <- as.factor(plot_data$scenario)
colors <- c("#6FB2C1", "#F11B00")
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL) +
theme_light(base_size = 16)
projection_plot
global_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 2023 &
year < 2101)
plot_data <- global_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
plot_data$scenario <- as.factor(plot_data$scenario)
colors <- c("#6FB2C1", "#F11B00")
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL) +
theme_light(base_size = 16)
projection_plot
historic_tas_subset <- subset(score0result_df, variable == GLOBAL_TAS()&
year > 1948 &
year < 2025)
historic_plot_data <- historic_tas_subset %>%
group_by(scenario, year) %>%
summarize(
median = weighted.quantile(value, w = mc_weight, probs = 0.5),
lower_ci = weighted.quantile(value, w = mc_weight, probs = 0.05),
upper_ci = weighted.quantile(value, w = mc_weight, probs = 0.95)) %>%
ungroup()
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black") +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, names = NULL) +
theme_light(base_size = 16)
projection_plot
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL) +
theme_light(base_size = 16)
projection_plot
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario)) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature Anomaly (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario") +
scale_fill_manual(values = colors, name = NULL, guide = "none") +
theme_light(base_size = 16)
projection_plot
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario),
linewidth = 0.5) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature Anomaly (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario", labels = c("GCAM Emissions", "SSP1-1.9")) +
scale_fill_manual(values = colors, name = NULL, guide = "none") +
theme_light(base_size = 16)
projection_plot
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario),
linewidth = 0.7) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature Anomaly (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario", labels = c("GCAM Emissions", "SSP1-1.9")) +
scale_fill_manual(values = colors, name = NULL, guide = "none") +
theme_light(base_size = 16)
projection_plot
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black",
linewidth = 0.7) +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
ggsave("workflow/results/fig_1.png",
device = "png",
width = 8,
height = 6,
unit = "in",
dpi = 300)
ggsave("workflow/results/fig_1.png",
device = "png",
width = 16,
height = 12,
unit = "in",
dpi = 300)
colors <- c("#6FB2C1", "#F11B00")
projection_plot <-
ggplot(data = plot_data) +
geom_line(
aes(x = year,
y = median,
color = scenario),
linewidth = 0.7) +
geom_ribbon(
aes(x = year,
ymin = lower_ci,
ymax = upper_ci,
fill = scenario), alpha = 0.2) +
labs(title = "Median GSAT",
x = "Year",
y = "Temperature Anomaly (\u00B0C)") +
scale_color_manual(values = colors, name = "Scenario", labels = c("GCAM Emissions", "SSP1-1.9")) +
scale_fill_manual(values = colors, name = NULL, guide = "none") +
theme_light(base_size = 35)
projection_plot
projection_plot +
geom_line(data = historic_plot_data,
aes(x = year,
y = median),
color = "black",
linewidth = 0.7) +
geom_ribbon(data = historic_plot_data,
aes(x = year,
ymin = lower_ci,
ymax = upper_ci),
fill = "black",
alpha = 0.2) +
geom_point(data = matilda:::adjusted_gmst_data,
aes(x = year, y = anomaly_C),
color = "black")
ggsave("workflow/results/fig_1.png",
device = "png",
width = 16,
height = 12,
unit = "in",
dpi = 300)
library(spatatat)
library(spatstat)
rgcam::loadProject("workflow/data/gcam_emissions.dat")
